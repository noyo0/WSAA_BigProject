<!-- WSAA 2024 - BigProject (Truckwash) Author: Norbert Antal -->
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>TruckWash</title>
        <!-- CSS only -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
        <link rel="preconnect" href="https://fonts.gstatic.com">
        <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">        
    </head>
    <body style="font-family: 'Roboto', sans-serif;">

        <div class="container">
            <div class="container">
                <img src="img/bg_web.png" class="img-fluid" alt="Banner">
            </div>
        <header class="p-4">
            <h1 style="color:#12226c;"> Truckwash</h1>
        </header>
        <!------List of washes--------->
        <div id="wash_list" class="container">
            <table id="wash_list_table" class="table">
                
            </table>
        </div>
        <!------Add Wash Button--------->
        <div><button  id="button-showCreate" onclick="showCreate()" class="btn btn-primary" style="background-color:#12226c">Enter new</button></div>

        <!------Add Wash Form--------->
        <div id='createUpdateForm' style="display: none"  class="container">
        <div class="row justify-content-center">
        <div class="col-md-6">
        <form>
        <header><br>
        <h3 style="color:#ffffff;background-color:#ff8c2d;">
        Add new wash
        </h3> 
        </header>
        <div class="form-group">
            <input type="text" class="form-control" placeholder="id" type="text" name="id"><br/>
            <input type="text" class="form-control" placeholder="Date" type="text" name="date"><br/>
            <input type="text" class="form-control" placeholder="Fleet Number" type="text" name="fleet_number"><br/>
            <input type="text" class="form-control" placeholder="Reg" type="number" name="reg"><br/>
            Type <select class="custom-select custom-select-sm" name="type">
                <option value="Euroliner">Euroliner</option>
                <option value="Trailer">Trailer</option>
                <option value="Fridge">Fridge</option>
            </select><br><br>
            <span><button id="butt_add_new" class="btn btn-primary" style="background-color:#12226c" onclick="doCreate()">Add new wash</button></span>
        </div>
        </form>
    </div>
    </div>
    </div>
    </div>

<!-- JavaScript-->
<script>
    function showCreate() {
        document.getElementById('button-showCreate').style.display = "none";
        //document.getElementById('wash_list_table').style.display = "none";
        document.getElementById('wash_list').style.display = "none";
        document.getElementById('createUpdateForm').style.display = "block";
    }

    function showList() {
        document.getElementById('button-showCreate').style.display = "block";
        //document.getElementById('wash_list_table').style.display = "block";
        document.getElementById('wash_list').style.display = "block";
        document.getElementById('createUpdateForm').style.display = "none";
    }
    function doCreate(){
        event.preventDefault();
        console.log("Adding a wash")
        storeFormValues()
        wash = storeFormValues()
        console.log(wash)
        clearForm()
        addWashToTable(wash)
        showList()
        }
    function addWashToTable(wash) {
        //add a row to the table
        var tableElement = document.getElementById('wash_list_table');
        var rowElement = tableElement.insertRow(-1);
        //add values to table
        var cell1 = rowElement.insertCell(0);
        cell1.innerHTML = wash.id;
        var cell2 = rowElement.insertCell(1);
        cell2.innerHTML = wash.date;
        var cell3 = rowElement.insertCell(2);
        cell3.innerHTML = wash.fleetNumber;
        var cell4 = rowElement.insertCell(3);
        cell4.innerHTML = wash.reg;
        var cell5 = rowElement.insertCell(4);
        cell5.innerHTML = wash.type;
        // Add Update link
        var cell6 = rowElement.insertCell(5);
        var updateLink = document.createElement('a');
        updateLink.href = '#';
        updateLink.textContent = 'Update';
        updateLink.onclick = function() {
            showUpdate(this);
        };
        cell6.appendChild(updateLink);
        // Add Delete link
        var cell7 = rowElement.insertCell(6);
        var deleteLink = document.createElement('a');
        deleteLink.href = '#';
        deleteLink.textContent = 'Delete';
        deleteLink.onclick = function() {
            doDelete();
        };
        cell7.appendChild(deleteLink);
}
        // UPDATE read out values from table row to update
    function getWashFromRow(rowElement) {
        var update_wash = {};
        truckwash.id = rowElement.cells[0].firstChild.textContent;
        truckwash.date = rowElement.cells[1].firstChild.textContent;
        truckwash.fleetNumber = rowElement.cells[2].firstChild.textContent;
        truckwash.reg = rowElement.cells[3].firstChild.textContent;
        truckwash.type = rowElement.cells[4].firstChild.textContent;
        return update_wash;
}
    // UPDATE populate a form with the data for update
    function populateFormWithWash(truckwash) {
        var form = document.getElementById('createUpdateForm');
        form.querySelector('input[name="id"]').disabled = true;
        form.querySelector('input[name="id"]').value = truckwash.id;
        form.querySelector('input[name="date"]').value = truckwash.date;
        form.querySelector('input[name="fleet_number"]').value = truckwash.fleetNumber;
        form.querySelector('input[name="reg"]').value = truckwash.reg;
        var selectElement = form.querySelector('select[name="type"]');
        selectElement.value = truckwash.type;
}
function showUpdate(linkElement) {
    var rowElement = linkElement.parentNode.parentNode;
    console.log(rowElement);
}
    function doUpdate(){
        console.log("Updating a wash")
        }
    function doDelete(){
        console.log("Deleting a wash")
        }
    function storeFormValues() {
        var form = document.getElementById('createUpdateForm');
        var wash = {};
        wash.id = form.querySelector('input[name="id"]').value;
        wash.date = form.querySelector('input[name="date"]').value;
        wash.fleetNumber = form.querySelector('input[name="fleet_number"]').value;
        wash.reg = form.querySelector('input[name="reg"]').value;
        wash.type = form.querySelector('select[name="type"]').value;
        return wash;
}
function clearForm() {
    var form = document.getElementById('createUpdateForm');
    form.querySelector('input[name="id"]').value = '';
    form.querySelector('input[name="date"]').value = '';
    form.querySelector('input[name="fleet_number"]').value = '';
    form.querySelector('input[name="reg"]').value = '';
    form.querySelector('select[name="type"]').value = 'instock'; // Assuming 'instock' is the default option
}

</script>

    </body>
</html>